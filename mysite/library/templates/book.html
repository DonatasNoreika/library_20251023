{% extends "base.html" %}

{% block title %}Knyga{% endblock %}

{% block content %}

{% load static %}
{% if book.cover %}
<img src="{{ book.cover.url }}" class="mb-3" style="max-width: 400px">
{% endif %}

<p>Pavadinimas: <strong>{{ book.title }}</strong></p>
<p>Autorius: <strong>{{ book.author }}</strong></p>
<p>ISBN: <strong>{{ book.isbn }}</strong></p>
<p>Žanrai: <strong>{{ book.display_genre }}</strong></p>
<p>{{ book.summary }}</p>
<hr>
<h4>Knygos kopijos:</h4>
{% for instance in book.instances.all %}
<p>
    {{ instance.uuid }} -
    <span class="{% if instance.status == 'a' %}text-success{% elif instance.status == 't' %}text-danger{% elif instance.status == 'r' %}text-warning{% endif %}">
        {{ instance.get_status_display }}
    </span>
    {% if instance.due_back %}
    <span>({{ instance.due_back | date:"Y-m-d" }})</span>
    {% endif %}
</p>
{% empty %}
<p>Neturime šios knygos kopijų</p>
{% endfor %}

<hr>
<h4>Atsiliepimai:</h4>
{% if user.is_authenticated %}
<h2>Palikite atsiliepimą:</h2>
<form method="post" class="mb-2">
    {% csrf_token %}
    {% load crispy_forms_tags %}
    {{ form | crispy }}
    <button type="submit" class="btn btn-primary">Paskelbti</button>
</form>
{% endif %}
{% for review in book.reviews.all %}

<p>
    {% if review.reviewer.photo %}
        <img src="{{ review.reviewer.photo.url }}" class="rounded-circle" style="width: 30px">
    {% else %}
        <img src="{% static 'img/blank-user.png' %}" class="rounded-circle" style="width: 30px">
    {% endif %}
    <strong>{{ review.reviewer }}</strong>, <em>{{ review.date_created }}</em>
</p>
<p class="mb-4">{{ review.content }}</p>
{% empty %}
<p>Nėra atsiliepimų</p>
{% endfor %}
{% endblock %}